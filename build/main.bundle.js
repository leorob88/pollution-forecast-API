(()=>{var t,e;const n={enableHighAccuracy:!0,maximumAge:3e4,timeout:27e3};function o(n,o){console.log(n+" "+o);const a=n*Math.PI/180,i=t*Math.PI/180,r=(t-n)*Math.PI/180,s=(e-o)*Math.PI/180,l=Math.sin(r/2)*Math.sin(r/2)+Math.cos(a)*Math.cos(i)*Math.sin(s/2)*Math.sin(s/2),u=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371e3/1e3;return Math.round(u)}function a(t){return t>300?"hazardous":t>200?"very unhealthy":t>150?"unhealthy":t>100?"unhealthy for sensitive groups":t>50?"moderate":"good"}function i(n,r){fetch(`/.netlify/functions/lambda?${n}`).then((t=>t.json())).then((n=>{if(console.log(n),"Unknown station"==n.data||2==r&&0==n.data.length)1==r?confirm("I couldn't find any stations for pollution detection in the location you searched for. Do you want to try a keyword search?")?i(`custom=${document.getElementById("query").value}`,2):document.getElementById("answer").innerHTML="I couldn't find any stations for pollution detection in the location you searched for.":2==r?confirm("I couldn't find any stations for pollution detection. Do you want to try a geolocation search?")?i(`latit=${t}&longi=${e}`,3):document.getElementById("answer").innerHTML="I couldn't find any stations for pollution detection. Be sure to provide a proper location keyword.":3==r&&(confirm("Wanna try name search?")?i(`city=${document.getElementById("query").value}`,1):document.getElementById("answer").innerHTML="I couldn't find any stations for pollution detection. Be sure to provide your current position");else if(2==r){console.log("array "+n.data.length),n.data.length,currentResult=n.data[0];let t=currentResult.aqi,e=o(currentResult.station.geo[0],currentResult.station.geo[1]);document.getElementById("answer").innerHTML=`The estimated AQI for ${currentResult.station.name} has a value of ${t}. The pollution rate is ${a(t)}.`,null==e&&null==e||(document.getElementById("answer").innerHTML+=`The estimated distance from your position is about ${e} kilometers.`)}else{let t=n.data.aqi,e=o(n.data.city.geo[0],n.data.city.geo[1]);1==r?document.getElementById("answer").innerHTML=`The estimated AQI for ${n.data.city.name} has a value of ${t}. The pollution rate is ${a(t)}.`:3==r&&(document.getElementById("answer").innerHTML=`The nearest station to your estimated position is in ${n.data.city.name}. The estimated AQI has a value of ${t}. The pollution rate is ${a(t)}.`),null==e&&null==e||(document.getElementById("answer").innerHTML+=`The estimated distance from your position is about ${e} kilometers.`)}document.getElementById("answer").innerHTML+=' For further details, you can check out the reference website infos <a target="_blank" href="https://www.airnow.gov/aqi/aqi-basics/">here</a>.'}))}new Promise(((t,e)=>navigator.geolocation.getCurrentPosition(t,e,n))).then((n=>{t=n.coords.latitude,e=n.coords.longitude})).catch((t=>{console.log(t)})),document.getElementById("butt0").addEventListener("click",(function(){i(`city=${document.getElementById("query").value}`,1)})),document.getElementById("butt1").addEventListener("click",(function(){i(`custom=${document.getElementById("query").value}`,2)})),document.getElementById("butt2").addEventListener("click",(function(){i(`latit=${t}&longi=${e}`,3)}))})();